# Usa imagem oficial do Python
FROM python:3.11-slim

# Instala o Git
RUN apt-get update && apt-get install -y git

# Define diret√≥rio de trabalho no container
WORKDIR /app

# Lista de reposit√≥rios para clonar
ENV REPOS="https://github.com/usuario/projeto_a.git https://github.com/usuario/projeto_b.git https://github.com/usuario/projeto_c.git"

# Clone ou atualize os reposit√≥rios
RUN for repo in $REPOS; do \
      dir=$(basename $repo .git); \
      if [ -d "$dir" ]; then \
        echo "üìÅ '$dir' j√° existe. Realizando git pull..."; \
        cd $dir && git pull && cd ..; \
      else \
        echo "üì• Clonando '$repo'..."; \
        git clone $repo; \
      fi \
    done

# Instala depend√™ncias de cada projeto
RUN pip install --no-cache-dir \
    -r projeto_a/requirements.txt \
    -r projeto_b/requirements.txt \
    -r projeto_c/requirements.txt

# Comando padr√£o para executar o script
CMD ["python", "run.py"]
